<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Coin Flip Demo – Circles</title>

<style>
/* ------------------------------------------------------------------
   0️⃣ Root variable – the “size” of a coin (square)
------------------------------------------------------------------ */
:root{
  /* pick the smaller of 27 vw or 27 vh so that coins never overflow the viewport
     (≈20 % larger than before) */
  --coin-base: min(27vw, 27vh);
}

/* ------------------------------------------------------------------
   Layout & controls – all px → vw/vh
------------------------------------------------------------------ */
#coin-demo{
  display:flex;
  flex-direction:column;
  align-items:center;
  justify-content:center;
  width:100%;
  max-width:100vw;
  margin:auto;
  height:70vh;
}
#coin-demo #controls{z-index:auto;margin-bottom:-1vh;}
/* Default button style – used by Flip! and number buttons */
#coin-demo button,#coin-demo select{
  padding:.25vw .6vw;
  font-size:4vh;
  margin-right:.4vw;
  border:none;background:#444;color:white;cursor:pointer;
  border-radius:1.2vw;

  /* Ensure buttons stay readable across screen sizes */
  min-width:6vw;
  max-width:16vw;
  max-height:8vh;
}
@media (max-width: 650px) {
#coin-demo button,#coin-demo select{
  min-width:10vw;
  min-height:10vw;

   font-size:6vh;
    max-width:34vw
}
}

#coin-demo button:hover{background:#555;}
.coin-btn.selected{background-color:#777;color:white;}

#numCoinsContainer{
  display:flex;
  justify-content:center;
}

/* Extra horizontal padding just for the number buttons */
#numCoinsContainer .coin-btn{
  /* keep vertical padding the same, bump horizontal padding up a bit */
  padding:.25vw .8vw;
}

/* ------------------------------------------------------------------
   Coin wrapper – all px → vw/vh
------------------------------------------------------------------ */
.coins-wrapper{
  display:flex;
  gap:1.25vw;
  justify-content:center;
  align-items:flex-end;
  position:relative;
  height:60vh;          /* 650 px → 81.25 vh (650 ÷ 8) */
  padding-top:4vh;
  perspective:1000px;
  pointer-events:none;
}

/* ------------------------------------------------------------------
   Coin – square & circle
------------------------------------------------------------------ */

.coin-container{
  position:relative;
  width:var(--coin-base);
  aspect-ratio:1/1;       /* height = width ⇒ square */
}
#coin-demo .coin-flip{
  width:100%;            /* fill the container (square) */
  height:100%;
  transform-style:preserve-3d;
  position:relative;
  top:calc(100% - 0vh);
  border-radius:50%;     /* makes it a circle */

  /* IMPORTANT – rotate around the centre so that letters stay centred */
  transform-origin:50% 50%;
}

/* ------------------------------------------------------------------
   Faces
------------------------------------------------------------------ */
.face{
  position:absolute;
  top:0;left:0;width:100%;height:100%;
  backface-visibility:hidden;
}
.front{z-index:2;}
.back{transform:rotateX(180deg);}

/* ------------------------------------------------------------------
   Stained‑glass texture – px → vw/vh
------------------------------------------------------------------ */
.stained-glass{
  width:100%; height:100%; position:relative;
  border-radius:50%;
  background-color:var(--stained-glass-color,#555);
  mix-blend-mode:multiply;
  background-image: radial-gradient(circle at center, transparent 98%, rgba(255, 255, 255, 0.1) 100%);
}



/* ------------------------------------------------------------------
   Fly & spin – px → vh
------------------------------------------------------------------ */
@keyframes fly-spin{
  from{top:100%;transform:translateY(0) rotateX(0deg);}
  /* translateY(-200 px) → -25 vh (200 ÷ 8) */
  to{top:10%;transform:translateY(-25vh) rotateX(calc(var(--flips)*180deg + var(--final-angle)) );}
}

/* ------------------------------------------------------------------
   Overlap styling – preserve overlap ratio
------------------------------------------------------------------ */
.coin-container:not(:first-child){
  /* -35 px → -0.291666 × coin size (35/120 = 29.1666%) */
  margin-left: calc(-0.291666 * var(--coin-base));
}

/* ------------------------------------------------------------------
   Letter styles on the faces
------------------------------------------------------------------ */
.letter{
  position:absolute;
  top:50%;left:50%;
  transform:translate(-50%,-50%);
  font-size: clamp(28px, 6vw, 38px);
  color:#f0e8d6;
  text-shadow:
    -1px -1px 0 rgba(255,255,255,.7),
     1px  1px 0 rgba(0,0,0,.5),
     2px  2px 4px rgba(0,0,0,.3);

  pointer-events:none;
  z-index:10;
}


/* ------------------------------------------------------------------
   Result overlay – unused but kept for reference
------------------------------------------------------------------ */
.result{
  position:absolute;
  top:50%;left:50%;
  transform:translate(-50%,-50%);
  font-size:5vw;color:white;text-shadow:0 .125vh .375vh rgba(0,0,0,.6);
  pointer-events:none;
  z-index:10;
}



</style>
</head>

<body>
<div id="coin-demo">
  <div id="controls"><label>Number of coins:</label>
    <div id="numCoinsContainer">
      <button class="coin-btn selected" data-num="1">1</button>
      <button class="coin-btn" data-num="2">2</button>
      <button class="coin-btn" data-num="3">3</button>
      <button class="coin-btn" data-num="4">4</button>
    </div>
  </div>

  <div id="flipContainer" style="margin-top:12px;">
<button id="flipBtn">&nbsp;&nbsp;Flip!&nbsp;&nbsp;</button>
  </div>

  <div class="coins-wrapper" id="wrapper"></div>
</div>

<script>
(() => {
  /* ------------------------------------------------------------------
     Translucent colours – alpha = 0.5
  ------------------------------------------------------------------ */
  const stainedGlassColors = [
       'rgba(139, 0, 139, 0.5)',    // magenta
   'rgba(0, 128, 0, 0.5)',      // green
           'rgba(70, 130, 180, 0.5)',    // steel blue
  'rgba(255, 200, 0, 0.5)',    // bright yellow (your “yellow” coin)
  'rgba(139, 69, 19, 0.5)',     // dark goldenrod – a darker yellow
   'rgba(255, 0, 0, 0.5)',      // red
        'rgba(0, 191, 255, 0.5)',    // deep sky blue
    'rgba(0, 0, 139, 0.5)',      // navy
          'rgba(128, 0, 128, 0.5)',    // purple
    'rgba(255, 165, 0, 0.5)',    // orange
  ];

  /* ------------------------------------------------------------------
     Create a single coin element
  ------------------------------------------------------------------ */
  function createCoin(colorIndex) {
    const container = document.createElement('div');
    container.className = 'coin-container';

    const c = document.createElement('div');
    c.className = 'coin-flip';
    c.style.setProperty('--stained-glass-color', stainedGlassColors[colorIndex]);

    // Front face
    const front = document.createElement('div');
    front.className = 'face front';
    const frontGlass = document.createElement('div');
    frontGlass.className = 'stained-glass';
    front.appendChild(frontGlass);

    // Letter H on the front
    const frontLabel = document.createElement('div');
    frontLabel.className = 'letter';
    frontLabel.textContent = 'H';
    frontLabel.style.visibility = 'hidden'; // hide until animation ends
    front.appendChild(frontLabel);

    // Back face
    const back = document.createElement('div');
    back.className = 'face back';
    const backGlass = document.createElement('div');
    backGlass.className = 'stained-glass';
    back.appendChild(backGlass);

    // Letter T on the back
    const backLabel = document.createElement('div');
    backLabel.className = 'letter';
    backLabel.textContent = 'T';
    backLabel.style.visibility = 'hidden';
    back.appendChild(backLabel);

    c.appendChild(front);
    c.appendChild(back);
    container.appendChild(c);

    return container;
  }

  /* ------------------------------------------------------------------
     Start the fly‑spin animation for one coin
  ------------------------------------------------------------------ */
  function startAnimation(coin) {
    const heads = Math.random() < 0.5;   // random outcome
    const flips = Math.floor(Math.random() * 4) + 4;   // 4‑7 flips

    let finalAngleDeg;
    if (heads) {
      finalAngleDeg = (flips % 2 === 0) ? 0 : 180;
    } else {
      finalAngleDeg = (flips % 2 === 0) ? 180 : 0;
    }

    coin.style.setProperty('--flips', flips);
    coin.style.setProperty('--final-angle', `${finalAngleDeg}deg`);

    // Ensure labels are hidden before new animation starts
    const container = coin.parentElement;
    const frontLabel = container.querySelector('.face.front .letter');
    const backLabel  = container.querySelector('.face.back .letter');
    if (frontLabel) frontLabel.style.visibility = 'hidden';
    if (backLabel ) backLabel.style.visibility  = 'hidden';

    // Restart animation
    coin.style.animation = 'none';
    void coin.offsetWidth;   // force reflow

    coin.style.animation =
      `fly-spin 2.5s cubic-bezier(0.175,0.885,0.32,1.29) forwards`;

    // Show correct letter after animation ends
    const handler = function () {
      if (heads) {
        frontLabel && (frontLabel.style.visibility = 'visible');
      } else {
        backLabel  && (backLabel.style.visibility  = 'visible');
      }
      coin.removeEventListener('animationend', handler);
    };
    coin.addEventListener('animationend', handler);
  }

  /* ------------------------------------------------------------------
     Show exactly n coins
  ------------------------------------------------------------------ */
  function displayCoins(n) {
    const wrapper = document.getElementById('wrapper');
    wrapper.innerHTML = '';          // clear any old coins

    for (let i = 0; i < n; i++) {
      const colorIndex = i % stainedGlassColors.length;
      const coinContainer = createCoin(colorIndex);
          coinContainer.style.zIndex = n - i;

      wrapper.appendChild(coinContainer);
    }
  }

  /* ------------------------------------------------------------------
     Initial state – one coin visible
  ------------------------------------------------------------------ */
  let selectedNum = 1;
  displayCoins(selectedNum);

  /* ------------------------------------------------------------------
     Number‑button handling
  ------------------------------------------------------------------ */
  const btns = document.querySelectorAll('#numCoinsContainer .coin-btn');
  btns.forEach(btn => {
    btn.addEventListener('click', () => {
      selectedNum = parseInt(btn.dataset.num, 10);
      btns.forEach(b => b.classList.remove('selected'));
      btn.classList.add('selected');

      displayCoins(selectedNum);
    });
  });

  /* ------------------------------------------------------------------
     Flip button – animate all existing coins
  ------------------------------------------------------------------ */
  const flipBtn = document.getElementById('flipBtn');
  let isAnimating = false;

  flipBtn.addEventListener('click', () => {
    if (isAnimating) return;          // ignore clicks while animating
    isAnimating = true;
    flipBtn.disabled = true;           // visual feedback

    const wrapper = document.getElementById('wrapper');
    const coins = Array.from(wrapper.querySelectorAll('.coin-flip'));
    let delay = 0;
    const staggerMs = 300;

    coins.forEach(coin => {
      setTimeout(() => startAnimation(coin), delay);
      delay += staggerMs;
    });

    const totalTime = (selectedNum - 1) * staggerMs + 2500;
    setTimeout(() => {
      isAnimating = false;
      flipBtn.disabled = false;
    }, totalTime);
  });
})();
</script>

</body>
</html>
