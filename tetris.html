<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Tetris</title>

<style>
    body {
        font-family: Arial, sans-serif;
        display: flex;
        justify-content: center;
        align-items: center;
        max-height: 100vh;
        margin: 0;
        margin-left: calc(23.5rem - 40vw);
                margin-top: 40px;

        background-color: #111;
        color: white;
    }
    .game-container {display:flex;gap:15px;}
    #tetris-board{
        width:300px;height:630px;border:2px solid #444;background:#111;
        position:relative;overflow:hidden;

    }

    /* side‑panel now a simple column – no space‑between */
    .side-panel{
        display:flex;
        flex-direction:column;
        gap:20px;
    }
    #next-piece{
        width:150px;
        height:150px;border:2px solid #444;background:#111;
        position:relative;overflow:hidden;
    }
    .stats{display:flex;flex-direction:column;gap:10px;}
    .stat-item{padding:5px;text-align:center;font-size:14px;}
    #next-label{
        position:absolute;top:5px;left:5px;color:#aaa;font-size:12px;
        background:rgba(0,0,0,.5);padding:2px 5px;
    }
    .controls{margin-top:20px;text-align:center;}

    .bottom-section{
        margin-top:auto;
        align-self:flex-start; width:150px;
        transform: translateX(3px);
    }



    .stow-box {
        width: 150px;
        height: 150px;
        border: 2px solid #444;
        background: #111;
        position: relative;
        overflow: hidden;
        margin-top: -179px;
    }
    #stow-label {
        position: absolute;
        top: 5px;
        left: 5px;
        color: #aaa;
        font-size: 12px;
        background: rgba(0, 0, 0, .5);
        padding: 2px 5px;
    }


</style>

<!-- I have a separate stylesheet -->
<link rel="stylesheet" href="eye.css">
</head>

<body>
<div class="game-container">

    <!-- Tetris board -->
    <canvas id="tetris-board" width="300" height="600"></canvas>

    <!-- Right‑hand side panel -->
    <div class="side-panel">

        <!-- Next piece preview -->
        <div id="next-piece">
            <canvas id="next-canvas" width="150" height="150"></canvas>
        </div>

        <!-- Eye component (bottom‑right of side panel) -->
<div class="eye-wrapper">
  <div class="eye-container">
    <div class="sclera"></div>
    <div class="moving-eye">
      <!-- New blink wrapper -->
      <div class="blink-wrapper">
        <div class="eye-inner">
          <div class="iris"></div>
          <div class="pupil"></div>
          <div class="cornea"></div>
          <div class="iris-texture"></div>
        </div>
      </div>
    </div>
  </div>
</div>

        <!-- stow box -->
<div class="stow-box">
    <canvas id="stow-canvas" width="150" height="150"></canvas>
</div>


        <!-- Bottom block: stats + controls -->
        <div class="bottom-section">

            <!-- Stats -->
            <div class="stats">
                <div class="stat-item"><strong>Score:</strong> <span id="score">0</span></div>
                <div class="stat-item"><strong>Level:</strong> <span id="level">1</span></div>
                <div class="stat-item"><strong>Lines:</strong> <span id="lines">0</span></div>
            </div>

            <!-- Game controls -->
            <div class="controls">
                <button id="start-btn">Restart</button>
                <button id="pause-btn">Pause</button>
            </div>

        </div>

    </div>
</div>

<!-- External Tetris script -->
<script src="tetris.js"></script>

<!-- -------------- Eye rotation logic ----------------- -->
<script>
const eyeIn = document.querySelector('.eye-inner');

function triggerEyeRotation() {
    if (!eyeIn.classList.contains('eye-rotating')) {
        eyeIn.classList.add('eye-rotating');
    } else {
        eyeIn.classList.remove('eye-rotating'); // reset
        void eyeIn.offsetWidth;                 // force re‑flow
        eyeIn.classList.add('eye-rotating');
    }
}

eyeIn.addEventListener('animationend', e => {
    if (e.animationName === 'rotateEye') {
        eyeIn.classList.remove('eye-rotating');
    }
});

/* ------------------------------------------------------------------
 *  Random‑blink scheduler – not tied to the animation iteration
 * ------------------------------------------------------------------ */
const minBlinkDelay = 5000; //  (minimum)
const maxBlinkDelay = 25000; // 20 s (maximum)

const blinkWrapper = document.querySelector('.blink-wrapper');

function triggerBlink() {
    if (!blinkWrapper.classList.contains('blinking')) {
        blinkWrapper.classList.add('blinking');
    }
}

blinkWrapper.addEventListener('animationend', e => {
    if (e.animationName === 'blink') {
        blinkWrapper.classList.remove('blinking');
    }
});

function scheduleNextBlink() {
    const delay =
        Math.random() * (maxBlinkDelay - minBlinkDelay) + minBlinkDelay;
    setTimeout(() => {
        triggerBlink();          // perform the blink
        scheduleNextBlink();     // schedule the next one
    }, delay);
}

// Start the random‑blink loop once the page has loaded
scheduleNextBlink();


/* ────────────────────── EYE LOOKING HELPERS ───────────────────── */
function resetAmbientAnimation(eyeInner) {
    eyeInner.style.animation = '';
    void eyeInner.offsetWidth;      // force re-flow
    eyeInner.style.animation = '';  // re-apply default animation from CSS

}

function triggerEyeDown() {
    const eyeInner = document.querySelector('.eye-inner');
    if (!eyeInner) return;

    eyeInner.classList.add('eye-looking-down');

    setTimeout(() => {
        eyeInner.classList.remove('eye-looking-down');
        resetAmbientAnimation(eyeInner);
    }, 1300);   // same duration as in the original code
}

function triggerEyeUp() {
    const eyeInner = document.querySelector('.eye-inner');
    if (!eyeInner) return;

    eyeInner.classList.add('eye-looking-up');

    setTimeout(() => {
        eyeInner.classList.remove('eye-looking-up');
        resetAmbientAnimation(eyeInner);
    }, 1300);
}

function triggerDizzyEye() {
    const eyeInner = document.querySelector('.eye-inner');
    if (!eyeInner) return;
    eyeInner.classList.add('eye-dizzy');

    setTimeout(() => {
        eyeInner.classList.remove('eye-dizzy');
    }, 1500);
}
</script>
</body>
</html>
